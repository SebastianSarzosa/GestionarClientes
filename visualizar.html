<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title>Visualización de Clientes Registrados</title>
  <link rel="stylesheet" href="visualizar.css">
</head>
<body>
  <div class="container">
    <div class="title-container">
      <h1 class="title">Clientes Registrados</h1>
    </div>
    <div id="mensaje"></div>
    <table id="tablaClientes">
      <thead>
        <tr>
          <th>Nombre Completo</th>
          <th>Usuario</th>
          <th>Email</th>
          <th>Numero De Telefono</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tablaBody"></tbody>
    </table>
    <div class="Registro1">
      <a class="visualizar1" href="RegistroCli.html">Ingrese aqui</a>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    // Configuración de Firebase
    const firebaseConfig = {
      // Tu configuración de Firebase aquí
      apiKey: "AIzaSyCdol1HUlezSerGhVYwP7CurgsnbiERfYM",
      authDomain: "coneccion-ab493.firebaseapp.com",
      databaseURL: "https://coneccion-ab493-default-rtdb.firebaseio.com",
      projectId: "coneccion-ab493",
      storageBucket: "coneccion-ab493.appspot.com",
      messagingSenderId: "1088096778093",
      appId: "1:1088096778093:web:22e7579ba164106b424c64"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const tablaBody = document.getElementById('tablaBody');
    
    // Obtener referencia a la lista de clientes registrados
    const clientesRef = ref(database, 'RegistroClientes');

    // Escuchar cambios en los datos
    onValue(clientesRef, (snapshot) => {
      tablaBody.innerHTML = '';

      // Recorrer los datos y agregarlos a la tabla
      snapshot.forEach((clienteSnapshot) => {
        const cliente = clienteSnapshot.val();
        const row = `<tr>
                      <td>${cliente.name}</td>
                      <td>${cliente.usuario}</td>
                      <td>${cliente.email}</td>
                      <td>${cliente.telefono}</td>
                      <td>
                        <button class="btn-modificar" onclick="modificarCliente('${clienteSnapshot.key}')">Editar</button>
                        <button class="btn-eliminar" onclick="eliminarCliente('${clienteSnapshot.key}')">Borrar</button>
                      </td>
                    </tr>`;
        tablaBody.innerHTML += row;
      });
    });

    function mostrarMensaje(mensaje, esError = false) {
      const mensajeDiv = document.getElementById('mensaje');
      mensajeDiv.textContent = mensaje;
      mensajeDiv.style.color = esError ? 'red' : 'green';
    }

    const eliminarCliente = (key) => {
  remove(ref(database, `RegistroClientes/${key}`), (error) => {
    if (error) {
      mostrarMensaje('Error al eliminar el cliente', true);
    } else {
      mostrarMensaje('Cliente eliminado correctamente', false);
    }
  });
};

  </script>
</body>
</html>
